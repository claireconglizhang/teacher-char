---
title: "The effects of teacher human capital characteristics"
output: html_document
date: '2022-09-28'
---
```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE,
                      include = FALSE,
                      message = FALSE)
pacman::p_load(tidyverse, janitor, rio, here, gtsummary, modelsummary, stargazer, huxtable, lfe, lubridate, psych)
```


```{r, functions}
`%!in%` <- Negate(`%in%`)

percentage <- function(x){
  paste(round(100*x, 2), "%", sep="")
}

round3 <- function(x){
  paste(round(x, digits = 3))
}

nmlz <- function(x){
  x = (x-mean(x, na.rm = TRUE))/sd(x, na.rm = TRUE)
  x
}

na_percentage <- function(x){
  y = sum(is.na(x))/length(x)
  paste(round(100*y, 2), "%", sep="")
}

mymean = function(x){
  x = combn(rev(x), n()-1, FUN = mean, na.rm = TRUE)
  x
}
```


```{r}
schid_full <- rio::import(here::here("data", "schid_full.csv"))
schid_random <- rio::import(here::here("data", "schid_random.csv"))
schid_nosorting <- rio::import(here::here("data", "schid_nosorting.csv"))
schid_nochange <- rio::import(here::here("data", "schid_nochange.csv"))
schid_nochange_2cls <- rio::import(here::here("data", "schid_nochange_2cls.csv"))

full_stu_1 <- rio::import(here::here("data", "cepsw1studentEN.dta")) 
full_stu_2 <- rio::import(here::here("data", "cepsw2studentEN.dta")) 
# w2status, followed-up = 1, missing = 2, newcomer = 3
full_stu <- inner_join(full_stu_1, full_stu_2) %>% ungroup() %>% filter(w2status == 1)

full_tch_1 <- rio::import(here::here("data", "cepsw1teacherEN.dta")) %>% filter(grade9 == 0)
full_tch_2 <- rio::import(here::here("data", "cepsw2teacherEN.dta"))
```

#### Outcomes of interest

 - Student academic performance (score)
 - Student academic confidence (conf)
 
```{r, student variables}
stu_var <- full_stu %>% 
  select(ids,
         schids,
         clsids,
         w2clsids,
         fall,
         mat = w2mat, # raw score
         chn = w2chn, # raw score
         eng = w2eng, # raw score
         cog = w2cog3pl, # CEPS standardized, score/mean = 0, sd = 1
         mat1 = stdmat, # CEPS standardized score/mean = 70, sd = 10
         chn1 = stdchn, # CEPS standardized score/mean = 70, sd = 10
         eng1 = stdeng, # CEPS standardized score/mean = 70, sd = 10
         cog1 = cog3pl, # CEPS standardized score/mean = 0, sd = 1
         female = stsex,
         birthyear= a02a, #some birthyear are coded as 2020, which may be a typo for 2002, swap 2020 for 2002 
         birthmonth = a02b, #some birthmonth are missing, recode 1 for NA
         only = stonly,
         rural = sthktype, 
         migrant = stmigrant, 
         medu = stmedu, 
         fedu = stfedu,
         income = steco_3c,
         matconf = w2b02,
         chnconf = w2b03,
         engconf = w2b04) %>% 
  mutate(birthyear = ifelse(birthyear == 2020, 2002, birthyear),
         birthmonth = ifelse(is.na(birthmonth), 1, birthmonth)) %>% 
  mutate(birth = ym(paste(birthyear, birthmonth, sep = "-")),
         entry = ym("2013-9"),
         age = floor(decimal_date(entry) - decimal_date(birth)), 
         female = recode(female, '1' = 0, '0' = 1),
         only = recode(only,'1' = 1, '2' = 0),
         migrant = recode(migrant,'1' = 0, '2' = 1, '3' = 1),
         medu = recode(medu, '1' = 0, '2' = 6, '3' = 9, '4' = 12, '5' = 12, '6' = 12, '7' = 14, '8' = 16, '9' = 19),
         fedu = recode(fedu, '1' = 0, '2' = 6, '3' = 9, '4' = 12, '5' = 12, '6' = 12, '7' = 14, '8' = 16, '9' = 19),
         income = recode(income, '1' = 0, '2' = 1, '3' = 2),
         mat1 = (mat1-70)/10,
         chn1 = (chn1-70)/10,
         eng1 = (eng1-70)/10,
         matconf = recode(matconf,'1' = 0, '2' = 1, '3' = 2, '4' = 3),
         chnconf = recode(chnconf,'1' = 0, '2' = 1, '3' = 2, '4' = 3),
         engconf = recode(engconf,'1' = 0, '2' = 1, '3' = 2, '4' = 3)) %>% 
  group_by(schids) %>% 
  mutate(chn = nmlz(chn),
         eng = nmlz(eng),
         mat = nmlz(mat),
         chnconf = nmlz(chnconf),
         engconf = nmlz(engconf),
         matconf = nmlz(matconf)) %>% 
  ungroup() %>% 
  group_by(clsids) %>% 
  mutate(hrsize = n(),
         hrfemale = mymean(female),
         hrage = mymean(age),
         hronly = mymean(only),
         hrrural = mymean(rural),
         hrmigrant = mymean(migrant),
         hrmedu = mymean(medu),
         hrfedu = mymean(fedu),
         hrincome = mymean(income)) %>% 
  ungroup() 
```


### Teacher human capital characteristics of interest 

 - Educational background 
   - years of education (tchedu)
   - graduate degree - master's and above (tchgrad) 
   - education major (tchmajor) 
 - Teaching experience
   - years of teaching (tchexp)
   - 1-2 years (tchexp1)
   - 3-4 years (tchexp2)
   - 5-9 years (tchexp3)
   - 10-14 years (tchexp4)
   - 15-24 years (tchexp5)
   - 25+ years (tchexp6)

 
```{r}
tch_var <- full_tch_2 %>% 
  select(schids,
         w2clsids,
         tchids,
         advisor = w2tchhr,
         subject = w2tchsubject,
         tchfemale = w2tchc01,
         tchexp = w2tchc08,
         tchedu = w2tchc04, 
         tchmajor = w2tchc05) %>% 
  mutate(tchfemale = recode(tchfemale, '2' = 1, '1' = 0),
         tchedu = recode(tchedu, '1' = 9, '2' = 12, '3' = 12, '4' = 14, '5' = 16, '6' = 16, '7' = 19),
         tchgrad = ifelse(tchedu == 19, 1, 0),
         tchexp1 = ifelse(tchexp >= 0 & tchexp <= 3, 1, 0),
         tchexp2 = ifelse(tchexp >= 4 & tchexp <= 6, 1, 0),
         tchexp3 = ifelse(tchexp >= 7 & tchexp <= 9, 1, 0),
         tchexp4 = ifelse(tchexp >= 10 & tchexp <= 12, 1, 0),
         tchexp5 = ifelse(tchexp >= 13 & tchexp <= 15, 1, 0),
         tchexp6 = ifelse(tchexp >= 16, 1, 0)) 

tch_var_chn <- tch_var %>% filter(subject == 2) 
tch_var_eng <- tch_var %>% filter(subject == 3)
tch_var_mat <- tch_var %>% filter(subject == 1)
```


```{r match students with teachers}
chn_full <- left_join(stu_var, tch_var_chn) %>% 
  ungroup()  %>% 
  select(ids, clsids, w2clsids, schids, fall, tchedu, tchgrad, tchexp, tchexp1:tchexp6,
         score = chn, conf = chnconf, 
         cog, chn1, eng1, mat1, cog1, female, age, only, rural, migrant, medu, fedu, income,
         tchfemale, advisor, 
         hrsize, hrfemale, hrage, hronly, hrrural, hrmigrant, hrmedu, hrfedu, hrincome)

eng_full <- left_join(stu_var, tch_var_eng) %>% 
  ungroup()  %>% 
  select(ids, clsids, w2clsids, schids, fall, tchedu, tchgrad, tchexp, tchexp1:tchexp6,
         score = eng, conf = engconf, 
         cog, chn1, eng1, mat1, cog1, female, age, only, rural, migrant, medu, fedu, income,
         tchfemale, advisor, 
         hrsize, hrfemale, hrage, hronly, hrrural, hrmigrant, hrmedu, hrfedu, hrincome)

mat_full <- left_join(stu_var, tch_var_mat) %>% 
  ungroup()  %>% 
  select(ids, clsids, w2clsids, schids, fall, tchedu, tchgrad, tchexp, tchexp1:tchexp6,
         score = mat, conf = matconf, 
         cog, chn1, eng1, mat1, cog1, female, age, only, rural, migrant, medu, fedu, income,
         tchfemale, advisor, 
         hrsize, hrfemale, hrage, hronly, hrrural, hrmigrant, hrmedu, hrfedu, hrincome)
```


```{r}
chn0 <- right_join(chn_full, schid_random) %>% ungroup() # for robustness check
eng0 <- right_join(eng_full, schid_random) %>% ungroup()
mat0 <- right_join(mat_full, schid_random) %>% ungroup()

chn0 <- right_join(chn_full, schid_nosorting) %>% ungroup() # for main analysis
eng0 <- right_join(eng_full, schid_nosorting) %>% ungroup()
mat0 <- right_join(mat_full, schid_nosorting) %>% ungroup()
```

### Missing data

```{r, include = TRUE}
apply(chn0, 2, na_percentage)
apply(eng0, 2, na_percentage)
apply(mat0, 2, na_percentage)
```

```{r}
# drop incomplete observations on predictor and outcome variables
chn <- chn0 %>% drop_na(c(tchedu, tchexp, score, conf, cog, cog1, chn1, eng1, mat1, tchfemale))
eng <- eng0 %>% drop_na(c(tchedu, tchexp, score, conf, cog, cog1, chn1, eng1, mat1, tchfemale))
mat <- mat0 %>% drop_na(c(tchedu, tchexp, score, conf, cog, cog1, chn1, eng1, mat1, tchfemale))
```


```{r}
# replace missing value on student covariates with homeroom mean
chn$age <- ifelse(!is.na(chn$age), chn$age, round(chn$hrage))
chn$only <- ifelse(!is.na(chn$only), chn$only, round(chn$hronly))
chn$rural <- ifelse(!is.na(chn$rural), chn$rural, round(chn$hrrural))
chn$migrant <- ifelse(!is.na(chn$migrant), chn$migrant, round(chn$hrmigrant))
chn$medu <- ifelse(!is.na(chn$medu), chn$medu, round(chn$hrmedu))
chn$fedu <- ifelse(!is.na(chn$fedu), chn$fedu, round(chn$hrfedu))
chn$income <- ifelse(!is.na(chn$income), chn$income, round(chn$hrincome))

eng$age <- ifelse(!is.na(eng$age), eng$age, round(eng$hrage))
eng$only <- ifelse(!is.na(eng$only), eng$only, round(eng$hronly))
eng$rural <- ifelse(!is.na(eng$rural), eng$rural, round(eng$hrrural))
eng$migrant <- ifelse(!is.na(eng$migrant), eng$migrant, round(eng$hrmigrant))
eng$medu <- ifelse(!is.na(eng$medu), eng$medu, round(eng$hrmedu))
eng$fedu <- ifelse(!is.na(eng$fedu), eng$fedu, round(eng$hrfedu))
eng$income <- ifelse(!is.na(eng$income), eng$income, round(eng$hrincome))

mat$age <- ifelse(!is.na(mat$age), mat$age, round(mat$hrage))
mat$only <- ifelse(!is.na(mat$only), mat$only, round(mat$hronly))
mat$rural <- ifelse(!is.na(mat$rural), mat$rural, round(mat$hrrural))
mat$migrant <- ifelse(!is.na(mat$migrant), mat$migrant, round(mat$hrmigrant))
mat$medu <- ifelse(!is.na(mat$medu), mat$medu, round(mat$hrmedu))
mat$fedu <- ifelse(!is.na(mat$fedu), mat$fedu, round(mat$hrfedu))
mat$income <- ifelse(!is.na(mat$income), mat$income, round(mat$hrincome))
```


```{r, include = TRUE}
apply(chn, 2, na_percentage)
apply(eng, 2, na_percentage)
apply(mat, 2, na_percentage)
```

### Analytic sample descriptive stats


```{r, include = TRUE, results = "asis"}
descript <- function(data){
  data %>%
    select(tchedu, tchgrad, tchexp, tchexp1:tchexp6, score, conf) %>%
    tbl_summary(
      type = list(c("tchedu", "tchexp", "score", "conf") ~ "continuous",
                  c("tchgrad", "tchexp1", "tchexp2", "tchexp3", "tchexp4", "tchexp5", "tchexp6") ~ "dichotomous"),
      statistic = list(all_continuous() ~ "{mean} ({min}, {max})",
                       all_categorical() ~ "{n} / {N} ({p}%)"),
      label = list(tchedu ~ "Education (in years)", 
                   tchgrad ~ "Graduate degree", 
                   tchexp ~ "Experience (in years)", 
                   tchexp1 ~ "0-3 years of experience",
                   tchexp2 ~ "4-6 years of experience",
                   tchexp3 ~ "7-9 years of experience",
                   tchexp4 ~ "10-12 years of experience",
                   tchexp5 ~ "13-15 years of experience",
                   tchexp6 ~ "16+ years of experience", 
                   score ~ "Score", 
                   conf ~ "Confidence")
      )
}

descript(chn)
descript(eng)
descript(mat)
```

### Random assignment check


```{r}
add_f <- function(model){
  f <- summary(model)$P.fstat
  star <- case_when(
    f[4] >= 0.05 ~ "",
    f[4]<0.05 & f[4]>=0.01 ~ "*",
    f[4]<0.01 & f[4]>=0.001 ~ "**",
    f[4] < 0.001 ~ "***")
  paste(round(f[5], 3), star, " (df = ", f[3], "; ", f[6], ")", sep = "")
}  
```


```{r, include = TRUE, results = "asis"}
random <- function(data, var){
  felm(var ~ chn1 + eng1 + mat1 + cog1 + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, data)
}

labels <- c("Baseline Chinese",
            "Baseline English",
            "Baseline math",
            "Baseline cognitive",
            "Female student",
            "Age",
            "Only child",
            "Rural residency",
            "Migrant worker family",
            "Mother education (years)",
            "Father education (years)",
            "Family income")

c1 <- random(chn, chn$tchedu)
c2 <- random(chn, chn$tchexp)
c3 <- random(eng, eng$tchedu)
c4 <- random(eng, eng$tchexp)
c5 <- random(mat, mat$tchedu)
c6 <- random(mat, mat$tchexp)

stargazer(c1, c2, c3, c4, c5, c6,
          type = "html",
          omit = c("Constant"),
          dep.var.caption = "",
          dep.var.labels = "",
          covariate.labels = labels,
          model.numbers = TRUE,
          column.labels = c("Education (in years)", "Experience (in years)", "Education (in years)", "Experience (in years)", "Education (in years)", "Experience (in years)"),
          star.cutoffs=c(0.05, 0.01, 0.001), 
          digits = 3, 
          flip = TRUE, 
          no.space = TRUE,
          notes.append=F, notes = c("*p$<$0.05, **p$<$0.01, ***p$<$0.001. Cells report coefficients and associated standard errors"),
          notes.align="l",
          add.lines = list(c("School Fixed Effects", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("Clusterred SE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("F-Statistics", add_f(c1), add_f(c2), add_f(c3), add_f(c4), add_f(c5), add_f(c6))))

```

#### Teacher educational background on student outcomes

```{r, include = TRUE, results = "asis"}
m1 <- felm(score ~ tchedu + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, chn)
m2 <- felm(score ~ tchedu + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, chn)
m3 <- felm(score ~ tchedu + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, chn)

m4 <- felm(score ~ tchedu + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, eng)
m5 <- felm(score ~ tchedu + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, eng)
m6 <- felm(score ~ tchedu + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, eng)

m7 <- felm(score ~ tchedu + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, mat)
m8 <- felm(score ~ tchedu + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, mat)
m9 <- felm(score ~ tchedu + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, mat)


stargazer(m1, m2, m3, m4, m5, m6, m7, m8, m9,
          type = "html",
          keep = c("\\btchedu\\b"),
          model.numbers = FALSE,
          dep.var.caption = "",
          dep.var.labels = c("", ""),
          column.labels = c("Chinese", "Chinese", "Chinese", "English", "English", "English", "Math", "Math", "Math"),
          star.cutoffs=c(0.05, 0.01, 0.001), 
          digits = 3, 
          flip = TRUE, 
          no.space = TRUE,
          notes.append=F, notes = c("*p$<$0.05, **p$<$0.01, ***p$<$0.001. Cells report coefficients and associated standard errors"),
          notes.align="l",
          add.lines = list(c("Student Covariates", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("Homeroom Covariates", "No", "Yes", "Yes", "No", "Yes", "Yes", "No", "Yes", "Yes"),
                           c("Teacher Covariates", "No", "No", "Yes", "No", "No", "Yes", "No", "No", "Yes"),
                           c("School FE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("School clustered SE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes")))
```

```{r, include = TRUE, results = "asis"}
m1 <- felm(score ~ tchgrad + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, chn)
m2 <- felm(score ~ tchgrad + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, chn)
m3 <- felm(score ~ tchgrad + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, chn)

m4 <- felm(score ~ tchgrad + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, eng)
m5 <- felm(score ~ tchgrad + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, eng)
m6 <- felm(score ~ tchgrad + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, eng)

m7 <- felm(score ~ tchgrad + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, mat)
m8 <- felm(score ~ tchgrad + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, mat)
m9 <- felm(score ~ tchgrad + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, mat)


stargazer(m1, m2, m3, m4, m5, m6, m7, m8, m9,
          type = "html",
          keep = c("\\btchgrad\\b"),
          model.numbers = FALSE,
          dep.var.caption = "",
          dep.var.labels = c("", ""),
          column.labels = c("Chinese", "Chinese", "Chinese", "English", "English", "English", "Math", "Math", "Math"),
          star.cutoffs=c(0.05, 0.01, 0.001), 
          digits = 3, 
          flip = TRUE, 
          no.space = TRUE,
          notes.append=F, notes = c("*p$<$0.05, **p$<$0.01, ***p$<$0.001. Cells report coefficients and associated standard errors"),
          notes.align="l",
          add.lines = list(c("Student Covariates", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("Homeroom Covariates", "No", "Yes", "Yes", "No", "Yes", "Yes", "No", "Yes", "Yes"),
                           c("Teacher Covariates", "No", "No", "Yes", "No", "No", "Yes", "No", "No", "Yes"),
                           c("School FE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("School clustered SE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes")))
```


#### Teacher experience on student outcomes

```{r, include = TRUE, results = "asis"}
m1 <- felm(score ~ tchexp + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, chn)
m2 <- felm(score ~ tchexp + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, chn)
m3 <- felm(score ~ tchexp + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, chn)

m4 <- felm(score ~ tchexp + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, eng)
m5 <- felm(score ~ tchexp + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, eng)
m6 <- felm(score ~ tchexp + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, eng)

m7 <- felm(score ~ tchexp + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, mat)
m8 <- felm(score ~ tchexp + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, mat)
m9 <- felm(score ~ tchexp + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, mat)


stargazer(m1, m2, m3, m4, m5, m6, m7, m8, m9,
          type = "html",
          keep = c("\\btchexp\\b"),
          model.numbers = FALSE,
          dep.var.caption = "",
          dep.var.labels = c("", ""),
          column.labels = c("Chinese", "Chinese", "Chinese", "English", "English", "English", "Math", "Math", "Math"),
          star.cutoffs=c(0.05, 0.01, 0.001), 
          digits = 3, 
          flip = TRUE, 
          no.space = TRUE,
          notes.append=F, notes = c("*p$<$0.05, **p$<$0.01, ***p$<$0.001. Cells report coefficients and associated standard errors"),
          notes.align="l",
          add.lines = list(c("Student Covariates", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("Homeroom Covariates", "No", "Yes", "Yes", "No", "Yes", "Yes", "No", "Yes", "Yes"),
                           c("Teacher Covariates", "No", "No", "Yes", "No", "No", "Yes", "No", "No", "Yes"),
                           c("School FE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("School clustered SE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes")))
```


```{r, include = TRUE, results = "asis"}
m1 <- felm(score ~ tchexp1 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, chn)
m2 <- felm(score ~ tchexp1 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, chn)
m3 <- felm(score ~ tchexp1 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, chn)

m4 <- felm(score ~ tchexp1 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, eng)
m5 <- felm(score ~ tchexp1 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, eng)
m6 <- felm(score ~ tchexp1 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, eng)

m7 <- felm(score ~ tchexp1 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, mat)
m8 <- felm(score ~ tchexp1 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, mat)
m9 <- felm(score ~ tchexp1 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, mat)


stargazer(m1, m2, m3, m4, m5, m6, m7, m8, m9,
          type = "html",
          keep = c("\\btchexp1\\b"),
          model.numbers = FALSE,
          dep.var.caption = "",
          dep.var.labels = c("", ""),
          column.labels = c("Chinese", "Chinese", "Chinese", "English", "English", "English", "Math", "Math", "Math"),
          star.cutoffs=c(0.05, 0.01, 0.001), 
          digits = 3, 
          flip = TRUE, 
          no.space = TRUE,
          notes.append=F, notes = c("*p$<$0.05, **p$<$0.01, ***p$<$0.001. Cells report coefficients and associated standard errors"),
          notes.align="l",
          add.lines = list(c("Student Covariates", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("Homeroom Covariates", "No", "Yes", "Yes", "No", "Yes", "Yes", "No", "Yes", "Yes"),
                           c("Teacher Covariates", "No", "No", "Yes", "No", "No", "Yes", "No", "No", "Yes"),
                           c("School FE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("School clustered SE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes")))
```


```{r, include = TRUE, results = "asis"}
m1 <- felm(score ~ tchexp2 +poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, chn)
m2 <- felm(score ~ tchexp2 +poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, chn)
m3 <- felm(score ~ tchexp2 +poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, chn)

m4 <- felm(score ~ tchexp2 +poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, eng)
m5 <- felm(score ~ tchexp2 +poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, eng)
m6 <- felm(score ~ tchexp2 +poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, eng)

m7 <- felm(score ~ tchexp2 +poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, mat)
m8 <- felm(score ~ tchexp2 +poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, mat)
m9 <- felm(score ~ tchexp2 +poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, mat)


stargazer(m1, m2, m3, m4, m5, m6, m7, m8, m9,
          type = "html",
          keep = c("\\btchexp2\\b"),
          model.numbers = FALSE,
          dep.var.caption = "",
          dep.var.labels = c("", ""),
          column.labels = c("Chinese", "Chinese", "Chinese", "English", "English", "English", "Math", "Math", "Math"),
          star.cutoffs=c(0.05, 0.01, 0.001), 
          digits = 3, 
          flip = TRUE, 
          no.space = TRUE,
          notes.append=F, notes = c("*p$<$0.05, **p$<$0.01, ***p$<$0.001. Cells report coefficients and associated standard errors"),
          notes.align="l",
          add.lines = list(c("Student Covariates", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("Homeroom Covariates", "No", "Yes", "Yes", "No", "Yes", "Yes", "No", "Yes", "Yes"),
                           c("Teacher Covariates", "No", "No", "Yes", "No", "No", "Yes", "No", "No", "Yes"),
                           c("School FE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("School clustered SE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes")))
```


```{r, include = TRUE, results = "asis"}
m1 <- felm(score ~ tchexp3 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, chn)
m2 <- felm(score ~ tchexp3 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, chn)
m3 <- felm(score ~ tchexp3 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, chn)

m4 <- felm(score ~ tchexp3 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, eng)
m5 <- felm(score ~ tchexp3 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, eng)
m6 <- felm(score ~ tchexp3 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, eng)

m7 <- felm(score ~ tchexp3 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, mat)
m8 <- felm(score ~ tchexp3 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, mat)
m9 <- felm(score ~ tchexp3 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, mat)


stargazer(m1, m2, m3, m4, m5, m6, m7, m8, m9,
          type = "html",
          keep = c("\\btchexp3\\b"),
          model.numbers = FALSE,
          dep.var.caption = "",
          dep.var.labels = c("", ""),
          column.labels = c("Chinese", "Chinese", "Chinese", "English", "English", "English", "Math", "Math", "Math"),
          star.cutoffs=c(0.05, 0.01, 0.001), 
          digits = 3, 
          flip = TRUE, 
          no.space = TRUE,
          notes.append=F, notes = c("*p$<$0.05, **p$<$0.01, ***p$<$0.001. Cells report coefficients and associated standard errors"),
          notes.align="l",
          add.lines = list(c("Student Covariates", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("Homeroom Covariates", "No", "Yes", "Yes", "No", "Yes", "Yes", "No", "Yes", "Yes"),
                           c("Teacher Covariates", "No", "No", "Yes", "No", "No", "Yes", "No", "No", "Yes"),
                           c("School FE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("School clustered SE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes")))
```



```{r, include = TRUE, results = "asis"}
m1 <- felm(score ~ tchexp4 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, chn)
m2 <- felm(score ~ tchexp4 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, chn)
m3 <- felm(score ~ tchexp4 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, chn)

m4 <- felm(score ~ tchexp4 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, eng)
m5 <- felm(score ~ tchexp4 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, eng)
m6 <- felm(score ~ tchexp4 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, eng)

m7 <- felm(score ~ tchexp4 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, mat)
m8 <- felm(score ~ tchexp4 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, mat)
m9 <- felm(score ~ tchexp4 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, mat)


stargazer(m1, m2, m3, m4, m5, m6, m7, m8, m9,
          type = "html",
          keep = c("\\btchexp4\\b"),
          model.numbers = FALSE,
          dep.var.caption = "",
          dep.var.labels = c("", ""),
          column.labels = c("Chinese", "Chinese", "Chinese", "English", "English", "English", "Math", "Math", "Math"),
          star.cutoffs=c(0.05, 0.01, 0.001), 
          digits = 3, 
          flip = TRUE, 
          no.space = TRUE,
          notes.append=F, notes = c("*p$<$0.05, **p$<$0.01, ***p$<$0.001. Cells report coefficients and associated standard errors"),
          notes.align="l",
          add.lines = list(c("Student Covariates", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("Homeroom Covariates", "No", "Yes", "Yes", "No", "Yes", "Yes", "No", "Yes", "Yes"),
                           c("Teacher Covariates", "No", "No", "Yes", "No", "No", "Yes", "No", "No", "Yes"),
                           c("School FE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("School clustered SE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes")))
```



```{r, include = TRUE, results = "asis"}
m1 <- felm(score ~ tchexp5 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, chn)
m2 <- felm(score ~ tchexp5 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, chn)
m3 <- felm(score ~ tchexp5 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, chn)

m4 <- felm(score ~ tchexp5 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, eng)
m5 <- felm(score ~ tchexp5 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, eng)
m6 <- felm(score ~ tchexp5 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, eng)

m7 <- felm(score ~ tchexp5 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, mat)
m8 <- felm(score ~ tchexp5 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, mat)
m9 <- felm(score ~ tchexp5 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, mat)


stargazer(m1, m2, m3, m4, m5, m6, m7, m8, m9,
          type = "html",
          keep = c("\\btchexp5\\b"),
          model.numbers = FALSE,
          dep.var.caption = "",
          dep.var.labels = c("", ""),
          column.labels = c("Chinese", "Chinese", "Chinese", "English", "English", "English", "Math", "Math", "Math"),
          star.cutoffs=c(0.05, 0.01, 0.001), 
          digits = 3, 
          flip = TRUE, 
          no.space = TRUE,
          notes.append=F, notes = c("*p$<$0.05, **p$<$0.01, ***p$<$0.001. Cells report coefficients and associated standard errors"),
          notes.align="l",
          add.lines = list(c("Student Covariates", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("Homeroom Covariates", "No", "Yes", "Yes", "No", "Yes", "Yes", "No", "Yes", "Yes"),
                           c("Teacher Covariates", "No", "No", "Yes", "No", "No", "Yes", "No", "No", "Yes"),
                           c("School FE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("School clustered SE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes")))
```



```{r, include = TRUE, results = "asis"}
m1 <- felm(score ~ tchexp6 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, chn)
m2 <- felm(score ~ tchexp6 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, chn)
m3 <- felm(score ~ tchexp6 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, chn)

m4 <- felm(score ~ tchexp6 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, eng)
m5 <- felm(score ~ tchexp6 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, eng)
m6 <- felm(score ~ tchexp6 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, eng)

m7 <- felm(score ~ tchexp6 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income | schids | 0 | schids, mat)
m8 <- felm(score ~ tchexp6 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome | schids | 0 | schids, mat)
m9 <- felm(score ~ tchexp6 + poly(cog1, 3) + poly(chn1, 3) + poly(eng1, 3) + poly(mat1, 3) + female + age + only + rural + migrant + medu + fedu + income + hrsize + hrfemale + hrage + hronly + hrrural + hrmigrant + hrmedu + hrfedu + hrincome + advisor + tchfemale | schids | 0 | schids, mat)


stargazer(m1, m2, m3, m4, m5, m6, m7, m8, m9,
          type = "html",
          keep = c("\\btchexp6\\b"),
          model.numbers = FALSE,
          dep.var.caption = "",
          dep.var.labels = c("", ""),
          column.labels = c("Chinese", "Chinese", "Chinese", "English", "English", "English", "Math", "Math", "Math"),
          star.cutoffs=c(0.05, 0.01, 0.001), 
          digits = 3, 
          flip = TRUE, 
          no.space = TRUE,
          notes.append=F, notes = c("*p$<$0.05, **p$<$0.01, ***p$<$0.001. Cells report coefficients and associated standard errors"),
          notes.align="l",
          add.lines = list(c("Student Covariates", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("Homeroom Covariates", "No", "Yes", "Yes", "No", "Yes", "Yes", "No", "Yes", "Yes"),
                           c("Teacher Covariates", "No", "No", "Yes", "No", "No", "Yes", "No", "No", "Yes"),
                           c("School FE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes"),
                           c("School clustered SE", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "Yes")))
```

